<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>게시글 수정</title>
    <link rel="stylesheet" th:href="@{/dist/css/adminlte.min.css}">
</head>
<body class="container mt-4">

<h2>게시글 수정</h2>

<form th:action="@{/posts/{id}/update(id=${post.id})}"
      th:object="${post}" method="post" enctype="multipart/form-data">

    <!-- 제목 -->
    <div class="mb-3">
        <label for="title" class="form-label">제목</label>
        <input type="text" th:field="*{title}" class="form-control" id="title"/>
    </div>

    <!-- 본문 -->
    <div class="mb-3">
        <label for="body" class="form-label">내용</label>
        <textarea th:field="*{body}" class="form-control" id="body" rows="5"></textarea>
    </div>

    <!-- 기존 첨부파일 -->
    <div th:if="${post.files}">
        <label>기존 첨부파일</label>
        <ul class="list-unstyled">
            <li th:each="f : ${post.files}">
                <label class="form-check-label">
                    <input class="form-check-input" type="checkbox" name="deleteFileIds" th:value="${f.id}">
                    <span th:text="${f.originalFilename}">filename</span>
                    <small>(<span th:text="${f.size}">0</span> bytes)</small>
                </label>
            </li>
        </ul>
        <small class="text-muted">삭제할 파일만 체크하세요. 체크 없으면 기존 파일 유지됩니다.</small>
    </div>

    <!-- 새 파일 업로드 -->
    <div class="mb-3">
        <label for="files" class="form-label">새 파일 첨부</label>
        <input type="file" id="files" name="files" multiple class="form-control"/>
    </div>

    <button type="submit" class="btn btn-primary">저장</button>
    <a th:href="@{/posts/{id}(id=${post.id})}" class="btn btn-secondary">취소</a>
</form>

</body>
</html>
