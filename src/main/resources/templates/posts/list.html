<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <script src="/js/beforeunload-killer.js"></script>
<!--    í˜ì´ì§€ë¥¼ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ? ë¼ëŠ” ì°½ì´ ëœ¨ì§€ì•Šë„ë¡ ë§‰ì•„ì¤Œ-->
    <meta charset="utf-8">
    <title>ê²Œì‹œê¸€ ëª©ë¡</title>


    <!-- â–¼ íŒŒë¹„ì½˜ (ê¸°ì¡´ ì´ë¯¸ì§€ë¡œ ëŒ€ì²´) -->
    <link rel="icon" type="image/png" href="/dist/img/AdminLTELogo.png">


    <link rel="stylesheet" th:href="@{/plugins/fontawesome-free/css/all.min.css}">
    <link rel="stylesheet" th:href="@{/dist/css/adminlte.min.css}">

    <!-- âœ… AJAXì—ì„œ ì“¸ CSRF ë©”íƒ€ -->
    <meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">

    <!-- SmartEditor2 -->
    <script th:src="@{/se2/js/HuskyEZCreator.js}" charset="utf-8"></script>
    <link rel="preload" href="/se2/SmartEditor2Skin.html" as="fetch">



    <style>
        /* ì¹´ë“œ í—¤ë”ì—ì„œ ê²€ìƒ‰ í¼ì„ ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ */
        .card-header .search-form { margin-left: auto !important; }

        /* í˜¹ì‹œ ê°€ìš´ë° ì •ë ¬ì´ ë‚¨ì•„ìˆì„ ë•Œ ê°•ì œ í•´ì œ */
        .card-header { text-align: left; }
    </style>
    <style>
        /* ëª¨ë‹¬ ë³¸ë¬¸ ì•ˆì— ìˆëŠ” ì¹´ë“œ í—¤ë”ë§Œ ê°ì¶¤ */
        #createModal .modal-body .card-header { display: none; }
    </style>



</head>

<body class="hold-transition">
<div class="container-fluid my-4"><!-- .container-fluid: í˜ì´ì§€ ì „ì²´ í­ -->
    <div class="row">
        <div class="col-12 col-lg-11 col-xl-10 mx-auto"><!-- ì¤‘ì•™ ê³ ì •í­ ì»¨í…Œì´ë„ˆ -->

            <!-- ìƒë‹¨ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ -->


            <div class="d-flex justify-content-end align-items-center mb-4">
                <form th:action="@{/logout}" method="post" class="mb-0">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button type="submit" class="btn btn-outline-danger btn-sm">ë¡œê·¸ì•„ì›ƒ</button>
                </form>
            </div>


            <!-- ì•Œë¦¼ -->
            <div th:replace="~{fragments/alerts :: alerts}"></div>

            <!-- ëª©ë¡ ì¹´ë“œ -->
            <div class="card">
                <div class="card-header d-flex align-items-center">
                    <h3 class="card-title mb-0">ê²Œì‹œê¸€ ëª©ë¡</h3>

                    <!-- ğŸ”¥ ê²€ìƒ‰ì°½: ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ ë°€ê¸° ìœ„í•´ search-formì— margin-left:auto -->
<!--                    ê²€ìƒ‰ì°½ í¼ ì œëª©, ë‚´ìš©, ì•„ì´ë””ë¡œ ê²€ìƒ‰ê°€ëŠ¥-->
                    <form th:action="@{/posts/list}" method="get" class="search-form mb-0">
                        <div class="input-group input-group-sm" style="width: 420px;">
                            <!-- í•„ë“œ ì„ íƒ -->
                            <select name="field" class="form-control" style="max-width:130px;">
                                <option value="title" th:selected="${field} == 'title'">ì œëª©</option>
                                <option value="body"  th:selected="${field} == 'body'">ë‚´ìš©</option>
                                <option value="user"  th:selected="${field} == 'user'">ì•„ì´ë””</option>
                            </select>

                            <!-- ê²€ìƒ‰ì–´ -->
                            <input type="text" name="query" class="form-control" placeholder="ê²€ìƒ‰ì–´" th:value="${query}">

                            <div class="input-group-append">
                                <button type="submit" class="btn btn-default">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                </div>


                <div class="card-body table-responsive p-0">
                    <table class="table table-hover text-nowrap">
                        <thead>
                        <tr class="text-center">
                            <th style="width:80px;">ê¸€ë²ˆí˜¸</th>
                            <th>ì œëª©</th>
                            <th>ë‚´ìš©</th>
                            <th style="width:90px;">ì²¨ë¶€íŒŒì¼</th>
                            <th style="width:180px;">íšŒì›ì•„ì´ë””</th>
                            <th style="width:170px;">ì‘ì„±ì¼</th>
                            <th style="width:170px;">ìˆ˜ì •ì¼</th>
                        </tr>
                        </thead>
                        <tbody id="post-list-body">
                        <tr th:each="p : ${posts.content}" class="text-center">
                            <td th:text="${p.id}"></td>
                            <td><a th:href="@{/posts/{id}(id=${p.id})}" th:text="${p.title}"data-bypass-unload="true">ì œëª©</a></td>
                            <td th:text="${p.bodyPreview}">ë¯¸ë¦¬ë³´ê¸°</td>
                            <td th:text="${idsWithFiles.contains(p.id)} ? 'Y' : ''" class="col-hasfile"></td>
                            <td th:text="${p.authorUserId}"></td>
                            <td th:text="${#temporals.format(p.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                            <td th:text="${#temporals.format(p.updateAt, 'yyyy-MM-dd HH:mm')}"></td>
                        </tr>
                        <tr id="no-posts-row" th:if="${#lists.isEmpty(posts.content)}">
                            <td colspan="6" class="text-center text-muted p-4">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card-footer clearfix">
                    <ul class="pagination pagination-sm m-0 float-right">
                        <li class="page-item" th:classappend="${posts.first} ? 'disabled'">
                            <a class="page-link" th:href="@{/posts/list(page=${posts.number-1}, size=${posts.size}, query=${query},field=${field})}">&laquo;</a>
                        </li>
                        <li class="page-item" th:each="i : ${#numbers.sequence(0, posts.totalPages-1)}"
                            th:classappend="${i} == ${posts.number} ? 'active'">
                            <a class="page-link"
                               th:text="${i+1}"
                               th:href="@{/posts/list(page=${i}, size=${posts.size}, query=${query}, field=${field})}">1</a>
                        </li>
                        <li class="page-item" th:classappend="${posts.last} ? 'disabled'">
                            <a class="page-link" th:href="@{/posts/list(page=${posts.number+1}, size=${posts.size}, query=${query},field=${field})}">&raquo;</a>
                        </li>
                    </ul>
                </div>
            </div><!-- /.card -->
            <div class="d-flex justify-content-end mb-3">
                <!-- ëª©ë¡: í°ìƒ‰(ì•„ì›ƒë¼ì¸) + ì˜¤ë¥¸ìª½ ë²„íŠ¼ê³¼ ê°„ê²© -->
                <a th:href="@{/posts/list(page=0, size=${posts.size})}"
                   class="btn btn-outline-secondary mr-2"
                   data-bypass-unload="true">ëª©ë¡</a>


                <button type="button"
                        class="btn btn-outline-primary mr-2"
                        data-toggle="modal"
                        data-target="#createModal"
                        data-bypass-unload="true">ìƒˆì°½</button>

                <!-- ê¸€ì“°ê¸°: íŒŒë€ìƒ‰ ê¸°ë³¸ -->
                <a th:href="@{/posts/create}"
                   class="btn btn-primary"
                   data-bypass-unload="true">ê¸€ì“°ê¸°</a>
            </div>


            <div class="clearfix"></div>

            <!-- ì¸ë¼ì¸ create: list í­ê³¼ ë…ë¦½ -->
            <div class="create-inline-wrap container mt-4">

<!--                divë¡œ ê³µê°„ì„ ë§Œë“¤ì–´ì„œ create-inline(listì— ì¶”ê°€í•  createí¼)ì„ ë„£ì–´ ì¹˜í™˜, ìŠ¤í”„ë§+íƒ€ì„ë¦¬í”„ê°€ ì„œë²„ì—ì„œ í…œí”Œë¦¿ì„ htmlë¡œ ë Œë”í•´ì„œ ë¸Œë¼ìš°ì €ë¡œ ë³´ë‚´ëŠ” ì„œë²„ì‚¬ì´ë“œ. th:replaceëŠ” ì„œë²„ì‚¬ì´ë“œ ì¡°ë¦½-->
                <div th:replace="~{posts/_create-inline :: inlineCreate('inl-')}"></div>
            </div>

        </div><!-- /.col -->
    </div><!-- /.row -->
</div><!-- /.container-fluid -->




<!-- ìƒˆì°½(ëª¨ë‹¬) -->
<div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">ìƒˆ ê¸€ ì‘ì„±(ìƒˆì°½)</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="ë‹«ê¸°">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- ëª¨ë‹¬: mdl- prefix -->
                <div th:replace="~{posts/_create-inline :: inlineCreate('mdl-')}"></div>
<!--                ëª¨ë‹¬ì—ì„œë„ create-inlineì‚¬ìš©, í˜¸ì¹­ ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ ë”°ë¡œ ì„¤ì •-->
            </div>
        </div>
    </div>
</div>



<!-- ìš©ëŸ‰ ì œí•œ ëª¨ë‹¬: í˜ì´ì§€ ì „ì—­ 1íšŒë§Œ -->
<div class="modal fade" id="sizeLimitModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">íŒŒì¼ í¬ê¸° ì œí•œ ì´ˆê³¼</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="ë‹«ê¸°">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="sizeLimitBody"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">í™•ì¸</button>
            </div>
        </div>
    </div>
</div>




<!-- í•„ìˆ˜ JS -->
<script th:src="@{/plugins/jquery/jquery.min.js}"></script>
<script th:src="@{/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/dist/js/adminlte.min.js}"></script>






<!--   ì¸ë¼ì¸+ëª¨ë‹¬ 2ë²Œ í¼ ê³µìš© ì´ˆê¸°í™” -->
<script th:inline="javascript">
    window.uploadDroppedFile = function(file, oEditor) {
        var formData = new FormData();
        formData.append('Filedata', file);
        jQuery.ajax({
            url: '/image-upload',
            type: 'POST',
            data: formData,
            processData: false, contentType: false,
            success: function(response) {
                var params = {};
                response.split('&').forEach(function(p){ var i=p.split('='); params[i[0]]=decodeURIComponent(i[1]); });
                if (params.sFileURL) {
                    oEditor.exec("PASTE_HTML", ['<img src="'+params.sFileURL+'" style="max-width:100%;">']);
                }
            },
            error: function(xhr) { alert('ì—…ë¡œë“œ ì‹¤íŒ¨: ' + xhr.responseText); }
        });
    };
    (function(){

        // â–· ë¦¬ìŠ¤íŠ¸ ìƒë‹¨ì— í–‰ ë¼ì›Œ ë„£ê³  ê°€ìš´ë°ì •ë ¬ ìœ ì§€
        function prependRowHtml(html){
            if(!html) return;
            $('#post-list-body').prepend(html); //ì„±ê³µì½œë°±ì˜ rowí•˜ë‚˜ë¥¼ ê½‚ì•„ë„£ìŒ post-list-bodyë¼ëŠ” idë¥¼ ê°€ì§„ê³³ì—ë‹¤ê°€
            $('#no-posts-row').remove();


        }

        // â–· ì—ë””í„° í­/ê³ ì •í­ ë³´ì • ìœ í‹¸ (ì „ì—­ ì¬ì‚¬ìš©)
        window.makeSE2Responsive = function(scopeEl){
            try{
                var iframe =
                    (scopeEl && scopeEl.querySelector && scopeEl.querySelector('iframe')) ||
                    document.querySelector('.editor-slot iframe') ||
                    document.querySelector('iframe[src*="SmartEditor2Skin"]');
                if(!iframe) return false;

                // ì™¸ê³½ iframe í­ 100%
                iframe.style.width = '100%';
                iframe.removeAttribute('width');

                var doc = iframe.contentDocument || iframe.contentWindow?.document;
                if(!doc) return false;

                // ë‚´ë¶€ ê³ ì •í­ ì œê±°
                if(!doc.getElementById('se2-rwd-css')){
                    var style = doc.createElement('style');
                    style.id = 'se2-rwd-css';
                    style.textContent = `
            html, body { width:100% !important; overflow-x:hidden !important; }
            .se2_mwrapper, .se2_inwrap, .se2_workarea, .se2_workspace,
            .se2_editor, .se2_input_area, .se2_ui_layout,
            .se2_container, .se2_canvas, .se2_wysiwyg_area,
            iframe, table, td { max-width:100% !important; width:100% !important; }
          `;
                    doc.head.appendChild(style);
                }

                function normalize(root){
                    root.querySelectorAll('[width], [style*="width"]').forEach(function(el){
                        var wAttr = el.getAttribute && el.getAttribute('width');
                        if (wAttr && /^\d+$/.test(wAttr)) el.setAttribute('width', '100%');
                        var sw = el.style && el.style.width;
                        if (sw && /px/.test(sw)) el.style.width = '100%';
                    });
                }
                normalize(doc);

                if(!doc.__se2Observer){
                    doc.__se2Observer = new MutationObserver(function(muts){
                        muts.forEach(function(m){
                            if (m.type === 'attributes') normalize(m.target);
                            m.addedNodes && m.addedNodes.forEach(function(n){
                                if (n.nodeType === 1) normalize(n);
                            });
                        });
                    });
                    doc.__se2Observer.observe(doc.documentElement, {
                        subtree:true, childList:true, attributes:true,
                        attributeFilter:['style','width']
                    });
                }
                return true;
            }catch(_){ return false; }
        };

        // â–· SmartEditor2 ì´ˆê¸°í™” (í¼ë³„ prefix)
        function initSE2(pf){
            window.oEditors = window.oEditors || [];
            var skinUri = /*[[@{/se2/SmartEditor2Skin.html}]]*/ '/se2/SmartEditor2Skin.html';
            skinUri += (skinUri.indexOf('?') === -1 ? '?' : '&') + 'v=' + Date.now();

            nhn.husky.EZCreator.createInIFrame({
                oAppRef: oEditors,
                elPlaceHolder: pf + 'body',
                sSkinURI: skinUri,
                fCreator: "createSEditor2",
                htParams: { bUseToolbar:true, bUseVerticalResizer:false, bUseModeChanger:true },

                // â˜… ì—¬ê¸°(onLoad)ì— slot/arm() ë¶™ìŒ
                fOnAppLoad: function () {
                    // 1) í¸ì§‘ì˜ì—­(ë³¸ë¬¸) ë†’ì´ ê³ ì •
                    try { oEditors.getById[pf + "body"].exec("RESIZE_EDITING_AREA", [420]); } catch(e){}

                    // 2) í­ ë³´ì •: í•´ë‹¹ prefix ìŠ¬ë¡¯ ë²”ìœ„ ë‚´ì—ì„œë§Œ ìˆ˜í–‰
                    var slot = document.getElementById(pf + 'editor-slot') || document;

                    function arm(){
                        var ok = window.makeSE2Responsive(slot);
                        if (ok) return;
                        var tries = 0, t = setInterval(function(){
                            if (window.makeSE2Responsive(slot) || ++tries > 80) clearInterval(t);
                        }, 100);
                    }
                    arm();
                    setTimeout(function(){ window.makeSE2Responsive(slot); }, 400);

                    // (ì„ íƒ) ëª¨ë‹¬/ì¸ë¼ì¸ ëª¨ë‘ iframe width ë³´ì •(ì¤‘ë³µ ì•ˆì „)
                    var ifr  = slot && slot.querySelector('iframe');
                    if (ifr){ ifr.style.width='100%'; ifr.removeAttribute('width'); }
                }
            });
        }

        // â–· íŒŒì¼ í”¼ì»¤/ë“œë¡­ì¡´ (í¼ë³„ prefix)
        function initPicker(pf){
            var MAX_FILE_SIZE_MB = 20, MAX_REQ_SIZE_MB = 25;
            var MAX_FILE_SIZE = MAX_FILE_SIZE_MB*1024*1024, MAX_REQ_SIZE = MAX_REQ_SIZE_MB*1024*1024;

            function fmt(b){var u=['B','KB','MB','GB'],i=0,n=b;while(n>=1024&&i<u.length-1){n/=1024;i++;}return (n<10&&i>0?n.toFixed(1):Math.round(n))+' '+u[i];}
            function keyOf(f){ return [f.name,f.size,f.lastModified].join('#'); }
            function showSizeModal(html){ $('#sizeLimitBody').html(html); $('#sizeLimitModal').modal('show'); }

            var $form   = $('#' + pf + 'postForm');
            var $btn    = $('#' + pf + 'addBtn-create');
            var $dz     = $('#' + pf + 'dz-create');
            var $picker = $('#' + pf + 'picker-create');
            var $input  = $('#' + pf + 'files-create');
            var $list   = $('#' + pf + 'list-create');

            if(!$form.length || !$btn.length || !$picker.length || !$input.length || !$list.length) return;

            var selected = new Map();

            function validate(files){
                var all = [...selected.values(), ...Array.from(files||[])];
                var total=0, over=[];
                all.forEach(f=>{ total+=f.size; if(f.size>MAX_FILE_SIZE) over.push(f); });
                if (over.length || total>MAX_REQ_SIZE){
                    var html='';
                    if (over.length){
                        html += '<div class="mb-2">ê°œë³„ íŒŒì¼ì€ ìµœëŒ€ <b>'+MAX_FILE_SIZE_MB+'MB</b>ê¹Œì§€ í—ˆìš©í•©ë‹ˆë‹¤.</div><ul>';
                        over.forEach(f=> html+='<li>'+f.name+' â€” '+fmt(f.size)+'</li>');
                        html += '</ul>';
                    }
                    if (total>MAX_REQ_SIZE) html += '<div class="mt-2">ì„ íƒí•œ íŒŒì¼ í•©ê³„ê°€ <b>'+MAX_REQ_SIZE_MB+'MB</b>ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.</div>';
                    showSizeModal(html); return false;
                }
                return true;
            }
            function syncHidden(){
                var dt = new DataTransfer();
                selected.forEach(f=> dt.items.add(f));
                $input[0].files = dt.files;
            }
            function render(){
                $list.empty();
                if(selected.size===0){ $list.append('<li class="list-group-item text-muted">ì„ íƒëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</li>'); return; }
                selected.forEach((f,k)=>{
                    var $li = $('<li class="list-group-item d-flex justify-content-between align-items-center"></li>');
                    $li.append('<span>'+f.name+' <small class="text-muted">â€” '+fmt(f.size)+'</small></span>');
                    var $del=$('<button type="button" class="btn btn-sm btn-outline-danger">ì‚­ì œ</button>');
                    $del.on('click', ()=>{ selected.delete(k); syncHidden(); render(); });
                    $li.append($del); $list.append($li);
                });
            }
            function addFiles(fileList){
                var unique = Array.from(fileList||[]).filter(f=>!selected.has(keyOf(f)));
                if(unique.length===0) return;
                if(!validate(unique)) return;
                unique.forEach(f=> selected.set(keyOf(f), f));
                syncHidden(); render();
            }

            $btn.on('click', ()=> $picker.trigger('click'));
            $picker.on('change', function(){ addFiles(this.files); this.value=''; });

            $dz.on('dragover', function(e){ e.preventDefault(); e.originalEvent.dataTransfer.dropEffect='copy'; $dz.addClass('bg-light'); });
            $dz.on('dragleave', function(){ $dz.removeClass('bg-light'); });
            $dz.on('drop', function(e){ e.preventDefault(); $dz.removeClass('bg-light'); addFiles(e.originalEvent.dataTransfer.files); });

            // í¼ë³„ ë¦¬ì…‹ í›…
            window['__resetFiles_' + pf] = function(){ selected.clear(); syncHidden(); render(); };

            render();
        }

        // â–· AJAX ì œì¶œ (í¼ë³„ prefix, listí•˜ë‹¨ê³¼ ìƒˆì°½ëª¨ë‹¬ ë‘˜ë‹¤ ë¹„ë™ê¸°)
        //submití•˜ë©´ ajaxê°€ í›”ì³ì™€ì„œ ë°ì´í„°ë¥¼ í¼ë°ì´í„°ë¡œ ìƒì„±í•˜ê³   pf + 'postForm'ì—ì„œ ë‚ ì•„ì˜¨ submití›”ì¹˜ëŠ”ê±°ì„
        //ê·¸ë¦¬ê³  posts/rowë¡œ ì „ì†¡
        function bindAjaxSubmit(pf, opts){
            var $form = $('#' + pf + 'postForm');
            if(!$form.length) return;

            $form.off('submit.inline').on('submit.inline', function(e){
                e.preventDefault();

                // ì—ë””í„° â†’ textarea ë°˜ì˜
                try { oEditors?.getById?.[pf + "body"]?.exec("UPDATE_CONTENTS_FIELD", []); } catch(e){}

                var title = $('#' + pf + 'title').val()?.trim();
                var body  = $('#' + pf + 'body').val()?.trim();
                if(!title){ alert('ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.'); $('#' + pf + 'title').focus(); return; }
                if(!body){  alert('ë³¸ë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”.'); return; }

                var fd = new FormData(this);
                $.ajax({
                    url: $form.attr('action'),  // /posts/row
                    method: 'POST',
                    data: fd,
                    processData: false,
                    contentType: false,
                    success: function(html){ //<tr>â€¦</tr> ë¬¸ìì—´ì´ html
                        // 1) ë¦¬ìŠ¤íŠ¸ì— ì¦‰ì‹œ ë°˜ì˜
                        prependRowHtml(html);

                        // 2) ì´ë²ˆ ì œì¶œì— íŒŒì¼ì´ ìˆì—ˆë‹¤ë©´ Y ì°ê¸°
                        try{
                            var hasFiles = (document.getElementById(pf + 'files-create')?.files?.length || 0) > 0;
                            if (hasFiles){
                                $('#post-list-body tr').first().find('.col-hasfile').text('Y');
                            }
                        }catch(_){}

                        // 3) í¼/ì—ë””í„°/íŒŒì¼ ë¦¬ì…‹
                        $('#' + pf + 'title').val('');
                        try { oEditors?.getById?.[pf + "body"]?.exec("SET_IR", ['']); } catch(e){ $('#' + pf + 'body').val(''); }
                        $('#' + pf + 'files-create').val('');
                        window['__resetFiles_' + pf]?.();

                        // 4) UX: ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤ + ëª¨ë‹¬ì´ë©´ ë‹«ê¸°
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        if (opts?.closeModal) $('#createModal').modal('hide');

                        // 5) ì™„ë£Œ ì•Œë¦¼
                        alert('ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    },
                    error: function(xhr){
                        alert('ë“±ë¡ ì‹¤íŒ¨: ' + (xhr.responseText || ''));
                    }
                });
            });
        }

        // ===== ì¸ë¼ì¸ í¼ ì¦‰ì‹œ ì´ˆê¸°í™” =====
        initSE2('inl-');
        initPicker('inl-');
        bindAjaxSubmit('inl-', { closeModal:false });

        // ===== ëª¨ë‹¬ í¼ì€ ì—´ë¦´ ë•Œ 1íšŒ ì´ˆê¸°í™” =====
        var modalInited = false;
        $('#createModal').on('shown.bs.modal', function(){
            if (modalInited) return;
            modalInited = true;
            initSE2('mdl-');
            initPicker('mdl-');
            bindAjaxSubmit('mdl-', { closeModal:true });
        });

        // ë¦¬ì‚¬ì´ì¦ˆ ë•Œ ê° ìŠ¬ë¡¯ë³„ë¡œ í­ ì¬ë³´ì •
        window.addEventListener('resize', function(){
            document.querySelectorAll('.editor-slot').forEach(function(el){
                requestAnimationFrame(function(){ window.makeSE2Responsive(el); });
            });
        });

    })();
</script>



<script defer th:src="@{/js/confirm.js}"></script>

</body>
</html>
